#!/bin/bash

# Run Maven compile and test commands
RED=$(tput setaf 1)
GREEN=$(tput setaf 2)
RESET=$(tput sgr0)
PURPLE=$(tput setaf 6)

mvn compile -pl server
if [ $? -eq 0 ]; then
    echo -e "${PURPLE}\n------------------------------------ [STUDIFY] ------------------------------------\n${GREEN}------------------------------------ [SUCCESS] ------------------------------------\n------------------------------------ [SUCCESS] ------------------------------------\n"
else
    echo -e "${PURPLE}\n---------------------------------- [STUDIFY] -----------------------------------\n${RED}------------------------------------ [ERROR] ------------------------------------\n------------------------------------ [ERROR] ------------------------------------\n\n\n\n${RESET}Pipeline failed.\nServer didn't compile\n\n"
    exit 1
fi
mvn compile -pl client
if [ $? -eq 0 ]; then
    echo -e "${PURPLE}\n------------------------------------ [STUDIFY] ------------------------------------\n${GREEN}------------------------------------ [SUCCESS] ------------------------------------\n------------------------------------ [SUCCESS] ------------------------------------\n"
else
    echo -e "${PURPLE}\n----------------------------------- [STUDIFY] -----------------------------------\n${RED}------------------------------------ [ERROR] ------------------------------------\n------------------------------------ [ERROR] ------------------------------------\n\n\n\n${RESET}Pipeline failed.\nClient didn't compile\n\n"
    exit 1
fi
mvn test -pl server
if [ $? -eq 0 ]; then
    echo -e "${PURPLE}\n------------------------------------ [STUDIFY] ------------------------------------\n${GREEN}------------------------------------ [SUCCESS] ------------------------------------\n------------------------------------ [SUCCESS] ------------------------------------\n"
else
    echo -e "${PURPLE}\n----------------------------------- [STUDIFY] -----------------------------------\n${RED}------------------------------------ [ERROR] ------------------------------------\n------------------------------------ [ERROR] ------------------------------------\n\n\n\n${RESET}Pipeline failed.\nServer tests didn't pass\n\n"
    exit 1
fi
mvn test -pl client
if [ $? -eq 0 ]; then
    echo -e "${PURPLE}\n------------------------------------ [STUDIFY] ------------------------------------\n${GREEN}------------------------------------ [SUCCESS] ------------------------------------\n------------------------------------ [SUCCESS] ------------------------------------\n"
else
    echo -e "${PURPLE}\n----------------------------------- [STUDIFY] -----------------------------------\n${RED}------------------------------------ [ERROR] ------------------------------------\n------------------------------------ [ERROR] ------------------------------------\n\n\n\n${RESET}Pipeline failed.\nClient tests didn't pass\n\n"
    exit 1
fi
  echo -e "${PURPLE}\n------------------------------------ [STUDIFY] ------------------------------------\n${GREEN}------------------------------------ [SUCCESS] ------------------------------------\n------------------------------------ [SUCCESS] ------------------------------------\n\n\n\n${RESET}Pipeline is successful. All tests passed.\n\n"
